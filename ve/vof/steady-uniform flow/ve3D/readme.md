VE3D's implementation.
