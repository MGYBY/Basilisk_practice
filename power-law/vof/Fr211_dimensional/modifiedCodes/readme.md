Modified codes, mainly the acceleration issue.
